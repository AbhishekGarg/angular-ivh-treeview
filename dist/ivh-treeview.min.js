angular.module("ivh.treeview",[]),angular.module("ivh.treeview").directive("ivhTreeviewCheckbox",["$timeout",function(a){"use strict";return{link:function(b,c,d){c.bind("change",function(){b.$broadcast("event_ivhTreeviewSelectAll",c.prop("checked")),a(function(){b.$emit("event_ivhTreeviewValidate")})}),c.bind("click",function(a){var e=b.$eval(d.ivhTreeviewCheckboxIndeterminate);e&&(c.prop("checked",!1),a.preventDefault(),a.stopImmediatePropagation())});var e=function(){a(function(){var a=b.$eval(d.ivhTreeviewCheckboxIndeterminate);c.prop("indeterminate",a)})};b.$on("event_ivhTreeviewValidate",e),b.$on("event_ivhTreeviewSelectAll",e)}}}]),angular.module("ivh.treeview").directive("ivhTreeviewNode",["$compile",function(){"use strict";return{restrict:"A",link:function(a,b,c){var d=c.ivhTreeviewNode,e=c.ivhTreeviewFilter,f=c.ivhTreeviewNodeVisibleAttribute,g=a.$eval(c.ivhTreeviewNode);if(e&&"undefined"!==e){var h=Array.prototype.map||function(a){var b=[];return angular.forEach(this,function(c){b.push(a(c))}),b},i=h.call(e.split("|"),function(a){var b=a.split(":");return b}),j=[];angular.forEach(i,function(a){Array.prototype.push.apply(j,a.slice(1))});var k="["+d+"] | "+e,l=function(){var b=a.$eval(k);g[f]=b.length>0};angular.forEach(j,function(b){a.$watch(b,l)})}}}}]),angular.module("ivh.treeview").directive("ivhTreeviewNodeToggle",["$timeout",function(a){"use strict";return{restrict:"A",link:function(b,c,d){for(var e=(b.$eval(d.ivhTreeviewNodeToggle),c.parent());e&&"LI"!==e.prop("nodeName");)e=e.parent();a(function(){e.hasClass("ivh-treeview-node-leaf")||c.bind("click",function(){e.toggleClass("ivh-treeview-node-collapsed")})})}}}]),angular.module("ivh.treeview").directive("ivhTreeview",["$compile",function(a){"use strict";return{restrict:"A",link:function(b,c,d){var e=d.ivhTreeview,f=d.ivhTreeviewFilter,g=b.$eval(d.ivhTreeviewLabelAttribute)||"label",h=b.$eval(d.ivhTreeviewChildrenAttribute)||"children",i=b.$eval(d.ivhTreeviewSelectedAttribute)||"selected",j=d.ivhTreeviewIndeterminateAttribute||"__ivhTreeviewIntermediate",k=d.ivhTreeviewVisibleAttribute||"__ivhTreeviewVisible",l=b.$eval(e),m=b.$eval(d.ivhTreeviewParent);if(l&&l.length){var n=['<ul class="ivh-treeview">','<li ng-repeat="itm in '+e+'"',"ng-class=\"{'ivh-treeview-node-leaf': !itm."+h+'.length}"','ivh-treeview-node="itm"','ivh-treeview-node-visible-attribute="'+k+'"','ivh-treeview-node-hook="itm"','ivh-treeview-filter="'+f+'"','ng-show="itm.'+k+'">','<div ivh-treeview-node-hook class="ivh-treeview-node">','<span ivh-treeview-node-toggle class="ivh-treeview-toggle ivh-treeview-toggle-right glyphicon glyphicon-chevron-right"></span>','<span ivh-treeview-node-toggle class="ivh-treeview-toggle ivh-treeview-toggle-down glyphicon glyphicon-chevron-down"></span>','<span class="ivh-treeview-toggle ivh-treeview-toggle-leaf">&#9679;</span>',"<input","ivh-treeview-checkbox",'ivh-treeview-checkbox-indeterminate="itm.'+j+'"','class="ivh-treeview-checkbox"','type="checkbox"','ng-model="itm.'+i+'" />','<span ivh-treeview-node-toggle="true" class="ivh-treeview-node-label">',"{{itm."+g+"}}","</span>","</div>","<div",'ivh-treeview="itm.'+h+'"','ivh-treeview-parent="itm"','ivh-treeview-filter="'+f+'"','ivh-treeview-label-attribute="'+g+'"','ivh-treeview-children-attribute="'+h+'"','ivh-treeview-selected-attribute="'+i+'"','ivh-treeview-visible-attribute="'+k+'"',"></div>","</li>","</ul>"].join("\n"),o=a(n)(b);c.html("").append(o),b.$on("event_ivhTreeviewSelectAll",function(a,b){angular.forEach(l,function(a){a[i]=b,a[j]=!1})}),m&&b.$on("event_ivhTreeviewValidate",function(){var a=l.length,b=0,c=0;angular.forEach(l,function(a){a[i]&&b++,a[j]&&c++}),0===b?(m[i]=!1,m[j]=!!c):b===a?(m[i]=!0,m[j]=!1):(m[i]=!1,m[j]=!0)})}}}}]);