angular.module("ivh.treeview",[]),angular.module("ivh.treeview").directive("ivhTreeviewCheckbox",["$timeout",function(a){"use strict";return{link:function(b,c,d){c.bind("change",function(){b.$broadcast("event_ivhTreeviewSelectAll",c.prop("checked")),a(function(){b.$emit("event_ivhTreeviewValidate")})}),c.bind("click",function(a){var e=b.$eval(d.ivhTreeviewCheckboxIndeterminate);e&&(c.prop("checked",!1),a.preventDefault(),a.stopImmediatePropagation())});var e=function(){a(function(){var a=b.$eval(d.ivhTreeviewCheckboxIndeterminate);c.prop("indeterminate",a)})};b.$on("event_ivhTreeviewValidate",e),b.$on("event_ivhTreeviewSelectAll",e)}}}]),angular.module("ivh.treeview").directive("ivhTreeviewNode",["$compile",function(){"use strict";return{restrict:"A",link:function(a,b,c){var d=c.ivhTreeviewNode,e=c.ivhTreeviewFilter,f=c.ivhTreeviewNodeVisibleAttribute,g=a.$eval(c.ivhTreeviewNode);if(e&&"undefined"!==e){var h=Array.prototype.map||function(a){var b=[];return angular.forEach(this,function(c){b.push(a(c))}),b},i=h.call(e.split("|"),function(a){var b=a.split(":");return b}),j=[];angular.forEach(i,function(a){Array.prototype.push.apply(j,a.slice(1))});var k="["+d+"] | "+e,l=function(){var b=a.$eval(k);g[f]=b.length>0};angular.forEach(j,function(b){a.$watch(b,l)})}}}}]),angular.module("ivh.treeview").directive("ivhTreeviewNodeToggle",["$timeout",function(a){"use strict";return{restrict:"A",link:function(b,c,d){for(var e=(b.$eval(d.ivhTreeviewNodeToggle),c.parent());e&&"LI"!==e.prop("nodeName");)e=e.parent();a(function(){e.hasClass("ivh-treeview-node-leaf")||c.bind("click",function(){e.toggleClass("ivh-treeview-node-collapsed")})})}}}]),angular.module("ivh.treeview").directive("ivhTreeview",["$compile","ivhTreeviewSettings",function(a,b){"use strict";return{restrict:"A",link:function(c,d,e){var f=b.get(),g=e.ivhTreeview,h=e.ivhTreeviewFilter,i=c.$eval(e.ivhTreeviewLabelAttribute)||f.labelAttribute,j=c.$eval(e.ivhTreeviewChildrenAttribute)||f.childrenAttribute,k=c.$eval(e.ivhTreeviewSelectedAttribute)||f.selectedAttribute,l=e.ivhTreeviewIndeterminateAttribute||f.indeterminateAttribute,m=e.ivhTreeviewVisibleAttribute||f.visibleAttribute,n=c.$eval(g),o=c.$eval(e.ivhTreeviewParent);if(n&&n.length){var p=['<ul class="ivh-treeview">','<li ng-repeat="itm in '+g+'"',"ng-class=\"{'ivh-treeview-node-leaf': !itm."+j+'.length}"','ivh-treeview-node="itm"','ivh-treeview-node-visible-attribute="'+m+'"','ivh-treeview-node-hook="itm"','ivh-treeview-filter="'+h+'"','ng-show="itm.'+m+'">','<div ivh-treeview-node-hook class="ivh-treeview-node">','<span ivh-treeview-node-toggle class="ivh-treeview-toggle ivh-treeview-toggle-right glyphicon glyphicon-chevron-right"></span>','<span ivh-treeview-node-toggle class="ivh-treeview-toggle ivh-treeview-toggle-down glyphicon glyphicon-chevron-down"></span>','<span class="ivh-treeview-toggle ivh-treeview-toggle-leaf">&#9679;</span>',"<input","ivh-treeview-checkbox",'ivh-treeview-checkbox-indeterminate="itm.'+l+'"','class="ivh-treeview-checkbox"','type="checkbox"','ng-model="itm.'+k+'" />','<span ivh-treeview-node-toggle="true" class="ivh-treeview-node-label">',"{{itm."+i+"}}","</span>","</div>","<div",'ivh-treeview="itm.'+j+'"','ivh-treeview-parent="itm"','ivh-treeview-filter="'+h+'"','ivh-treeview-label-attribute="'+i+'"','ivh-treeview-children-attribute="'+j+'"','ivh-treeview-selected-attribute="'+k+'"','ivh-treeview-visible-attribute="'+m+'"',"></div>","</li>","</ul>"].join("\n"),q=a(p)(c);d.html("").append(q),c.$on("event_ivhTreeviewSelectAll",function(a,b){angular.forEach(n,function(a){a[k]=b,a[l]=!1})}),o&&c.$on("event_ivhTreeviewValidate",function(){var a=n.length,b=0,c=0;angular.forEach(n,function(a){a[k]&&b++,a[l]&&c++}),0===b?(o[k]=!1,o[l]=!!c):b===a?(o[k]=!0,o[l]=!1):(o[k]=!1,o[l]=!0)})}}}}]),angular.module("ivh.treeview").provider("ivhTreeviewSettings",function(){"use strict";var a={labelAttribute:"label",childrenAttribute:"children",selectedAttribute:"selected",indeterminateAttribute:"__ivhTreeviewIntermediate",visibleAttribute:"__ivhTreeviewVisible"};this.set=function(b){angular.extend(a,b)},this.$get=function(){return{get:function(){return angular.copy(a)}}}});